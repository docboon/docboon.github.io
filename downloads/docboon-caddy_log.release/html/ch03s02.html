<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <title>2.&nbsp;&#21453;&#21521;&#20195;&#29702;&#26381;&#21153;&#22120;</title><link rel="stylesheet" type="text/css" href="themes/default/style/style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><style type="text/css">
body { background-image: url('themes/default/style/draft.png');
       background-repeat: no-repeat;
       background-position: top left;
       /* The following properties make the watermark "fixed" on the page. */
       /* I think that's just a bit too distracting for the reader... */
       /* background-attachment: fixed; */
       /* background-position: center center; */
     }</style><link rel="home" href="index.html" title="Caddy&#26085;&#24535;&#21442;&#32771;&#25163;&#20876;"><link rel="up" href="ch03.html" title="&#31532;&nbsp;3&nbsp;&#31456;&nbsp;&#37197;&#32622;&#26696;&#20363;&#21450;&#26085;&#24535;&#35299;&#26512;"><link rel="prev" href="ch03.html" title="&#31532;&nbsp;3&nbsp;&#31456;&nbsp;&#37197;&#32622;&#26696;&#20363;&#21450;&#26085;&#24535;&#35299;&#26512;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">2.&nbsp;&#21453;&#21521;&#20195;&#29702;&#26381;&#21153;&#22120;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch03.html"><img src="themes/default/navig/prev.png" alt="&#19978;&#19968;&#39029;"></a>&nbsp;</td><th width="60%" align="center">&#31532;&nbsp;3&nbsp;&#31456;&nbsp;&#37197;&#32622;&#26696;&#20363;&#21450;&#26085;&#24535;&#35299;&#26512;</th><td width="20%" align="right">&nbsp;</td></tr></table></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1077"></a>2.&nbsp;&#21453;&#21521;&#20195;&#29702;&#26381;&#21153;&#22120;</h2></div></div></div><p>&#25105;&#20204;&#25509;&#19979;&#26469;&#26356;&#25913;<code class="filename">Caddyfile</code>&#25991;&#20214;&#65292;&#20351;&#29992;<span class="command"><strong>json</strong></span>&#30340;&#26684;&#24335;&#26469;&#23553;&#35013;&#26085;&#24535;&#20449;&#24687;&#65292;&#24182;&#20351;&#29992;<span class="command"><strong>caddy run</strong></span>&#21629;&#20196;&#26469;&#37325;&#26032;&#36816;&#34892;caddy&#65306;</p><div class="programlistingco"><pre class="programlisting">&nbsp;&nbsp;1 :80 {
&nbsp;&nbsp;2 	file_server
&nbsp;&nbsp;3 	reverse_proxy 192.168.31.34:80 192.168.31.66:80
&nbsp;&nbsp;4 	log {
&nbsp;&nbsp;5 		output file /var/log/caddy/reverse_proxy.log
&nbsp;&nbsp;6 		format json     <span class="co" id="ReverseLogJson-co"><img src="themes/default/callouts/1.png" alt="(1)"></span>
&nbsp;&nbsp;7 	}
&nbsp;&nbsp;8 }</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a name="ReverseLogJson"></a><span><img src="themes/default/callouts/1.png" alt="1" border="0"></span></p></td><td valign="top" align="left"><p>&#25351;&#23450;&#26085;&#24535;&#26684;&#24335;&#26159;<span class="command"><strong>json</strong></span>&#12290;</p></td></tr></table></div></div><p>&#25152;&#26377;&#30340;&#26085;&#24535;&#20449;&#24687;&#23601;&#34987;&#23553;&#35013;&#25104;&#19968;&#26465;json&#32467;&#26500;&#30340;&#25968;&#25454;&#65306;</p><pre class="screen">&nbsp;&nbsp;1 {
&nbsp;&nbsp;2   "level": "info",
&nbsp;&nbsp;3   "ts": 1640923648.1757836,
&nbsp;&nbsp;4   "logger": "http.log.access.log0",
&nbsp;&nbsp;5   "msg": "handled request",
&nbsp;&nbsp;6   "request": {
&nbsp;&nbsp;7     "remote_addr": "192.168.31.56:35206",
&nbsp;&nbsp;8     "proto": "HTTP/1.1",
&nbsp;&nbsp;9     "method": "GET",
&nbsp;10     "host": "192.168.31.9",
&nbsp;11     "uri": "/index.html",
&nbsp;12     "headers": {
&nbsp;13       "Connection": ["keep-alive"],
&nbsp;14       "If-Modified-Since": ["Mon, 15 Nov 2021 08:30:02 GMT"],
&nbsp;15       "If-None-Match": ["W/\"61921a8a-2b1\""],
&nbsp;16       "Cache-Control": ["max-age=0"],
&nbsp;17       "Upgrade-Insecure-Requests": ["1"],
&nbsp;18       "User-Agent": ["Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0"],
&nbsp;19       "Accept": ["text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"],
&nbsp;20       "Accept-Language": ["zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2"],
&nbsp;21       "Accept-Encoding": ["gzip, deflate"]
&nbsp;22     }
&nbsp;23   },
&nbsp;24   "common_log": "192.168.31.56 - - [31/Dec/2021:12:07:28 +0800] \"GET /index.html HTTP/1.1\"
&nbsp;25                  200 399",
&nbsp;26   "user_id": "",
&nbsp;27   "duration": 0.001988705,
&nbsp;28   "size": 399,
&nbsp;29   "status": 200,
&nbsp;30   "resp_headers": {
&nbsp;31     "Date": ["Fri, 31 Dec 2021 04:07:28 GMT"],
&nbsp;32     "Server": ["Caddy","nginx/1.18.0"],
&nbsp;33     "Content-Type": ["text/html"],
&nbsp;34     "Last-Modified": ["Fri, 31 Dec 2021 04:07:06 GMT"],
&nbsp;35     "Etag": ["W/\"61ce81ea-27f\""],
&nbsp;36     "Content-Encoding": ["gzip"]
&nbsp;37   }
&nbsp;38 }</pre><p>nginx&#26381;&#21153;&#22120;&#30340;&#26085;&#24535;&#65306;</p><pre class="screen">&nbsp;&nbsp;1 192.168.31.9 - - [31/Dec/2021:12:07:28 +0800] "GET /index.html HTTP/1.1" 200 411 "-" 
&nbsp;&nbsp;2              "Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0"</pre></div><div class="navfooter"><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch03.html"><img src="themes/default/navig/prev.png" alt="&#19978;&#19968;&#39029;"></a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch03.html"><img src="themes/default/navig/up.png" alt="&#19978;&#19968;&#32423;"></a></td><td width="40%" align="right">&nbsp;</td></tr><tr><td width="40%" align="left" valign="top">&#31532;&nbsp;3&nbsp;&#31456;&nbsp;&#37197;&#32622;&#26696;&#20363;&#21450;&#26085;&#24535;&#35299;&#26512;&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="themes/default/navig/home.png" alt="&#36215;&#22987;&#39029;"></a></td><td width="40%" align="right" valign="top">&nbsp;</td></tr></table></div></body></html>